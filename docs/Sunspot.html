<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Module: Sunspot
  
    &mdash; Documentation by YARD 0.7.3
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '';
  if (relpath != '') relpath += '/';
</script>

  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="_index.html">Index (S)</a> &raquo; 
    
    
    <span class="title">Sunspot</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a id="class_list_link" href="#">Class List</a>
  
    <a id="method_list_link" href="#">Method List</a>
  
    <a id="file_list_link" href="#">File List</a>
  
</div>
      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Module: Sunspot
  
  
  
</h1>

<dl class="box">
  
  
    
  
    
  
  
  
    <dt class="r1 last">Defined in:</dt>
    <dd class="r1 last">sunspot/lib/sunspot.rb<span class="defines">,<br />
  sunspot/lib/sunspot/type.rb,<br /> sunspot/lib/sunspot/util.rb,<br /> sunspot/lib/sunspot/setup.rb,<br /> sunspot/lib/sunspot/field.rb,<br /> sunspot/lib/sunspot/query.rb,<br /> sunspot/lib/sunspot/schema.rb,<br /> sunspot/lib/sunspot/search.rb,<br /> sunspot/lib/sunspot/session.rb,<br /> sunspot/lib/sunspot/indexer.rb,<br /> sunspot/lib/sunspot/version.rb,<br /> sunspot/lib/sunspot/adapters.rb,<br /> sunspot/lib/sunspot/query/geo.rb,<br /> sunspot/lib/sunspot/dsl/scope.rb,<br /> sunspot/lib/sunspot/class_set.rb,<br /> sunspot/lib/sunspot/query/sort.rb,<br /> sunspot/lib/sunspot/search/hit.rb,<br /> sunspot/lib/sunspot/dsl/search.rb,<br /> sunspot/lib/sunspot/dsl/fields.rb,<br /> sunspot/lib/sunspot/query/scope.rb,<br /> sunspot_rails/lib/sunspot/rails.rb,<br /> sunspot/lib/sunspot/dsl/function.rb,<br /> sunspot/lib/sunspot/query/filter.rb,<br /> sunspot/lib/sunspot/query/dismax.rb,<br /> sunspot/lib/sunspot/dsl/fulltext.rb,<br /> sunspot/lib/sunspot/session_proxy.rb,<br /> sunspot/lib/sunspot/field_factory.rb,<br /> sunspot/lib/sunspot/configuration.rb,<br /> sunspot/lib/sunspot/dsl/functional.rb,<br /> sunspot_solr/lib/sunspot/solr/java.rb,<br /> sunspot/lib/sunspot/dsl/adjustable.rb,<br /> sunspot/lib/sunspot/data_extractor.rb,<br /> sunspot/lib/sunspot/composite_setup.rb,<br /> sunspot/lib/sunspot/dsl/field_query.rb,<br /> sunspot/lib/sunspot/dsl/restriction.rb,<br /> sunspot/lib/sunspot/dsl/query_facet.rb,<br /> sunspot/lib/sunspot/dsl/paginatable.rb,<br /> sunspot/lib/sunspot/search/highlight.rb,<br /> sunspot/lib/sunspot/text_field_setup.rb,<br /> sunspot/lib/sunspot/search/facet_row.rb,<br /> sunspot_solr/lib/sunspot/solr/server.rb,<br /> sunspot/lib/sunspot/query/connective.rb,<br /> sunspot/lib/sunspot/query/pagination.rb,<br /> sunspot/lib/sunspot/query/field_facet.rb,<br /> sunspot/lib/sunspot/search/date_facet.rb,<br /> sunspot/lib/sunspot/query/boost_query.rb,<br /> sunspot_solr/lib/sunspot/solr/railtie.rb,<br /> sunspot/lib/sunspot/query/restriction.rb,<br /> sunspot/lib/sunspot/query/query_facet.rb,<br /> sunspot_rails/lib/sunspot/rails/server.rb,<br /> sunspot/lib/sunspot/search/field_facet.rb,<br /> sunspot/lib/sunspot/search/query_facet.rb,<br /> sunspot/lib/sunspot/dsl/standard_query.rb,<br /> sunspot/lib/sunspot/query/common_query.rb,<br /> sunspot/lib/sunspot/query/highlighting.rb,<br /> sunspot_rails/lib/sunspot/rails/railtie.rb,<br /> sunspot_solr/lib/sunspot/solr/installer.rb,<br /> sunspot/lib/sunspot/query/standard_query.rb,<br /> sunspot/lib/sunspot/query/more_like_this.rb,<br /> sunspot/lib/sunspot/query/function_query.rb,<br /> sunspot_rails/lib/sunspot/rails/adapters.rb,<br /> sunspot/lib/sunspot/query/sort_composite.rb,<br /> sunspot_rails/lib/sunspot/rails/searchable.rb,<br /> sunspot/lib/sunspot/query/text_field_boost.rb,<br /> sunspot/lib/sunspot/query/date_field_facet.rb,<br /> sunspot/lib/sunspot/search/standard_search.rb,<br /> sunspot/lib/sunspot/search/abstract_search.rb,<br /> sunspot_rails/lib/sunspot/rails/spec_helper.rb,<br /> sunspot/lib/sunspot/query/composite_fulltext.rb,<br /> sunspot/lib/sunspot/dsl/more_like_this_query.rb,<br /> sunspot_rails/lib/sunspot/rails/solr_logging.rb,<br /> sunspot_rails/lib/sunspot/rails/configuration.rb,<br /> sunspot/lib/sunspot/dsl/restriction_with_near.rb,<br /> sunspot/lib/sunspot/query/more_like_this_query.rb,<br /> sunspot_rails/lib/sunspot/rails/log_subscriber.rb,<br /> sunspot/lib/sunspot/query/abstract_field_facet.rb,<br /> sunspot/lib/sunspot/search/paginated_collection.rb,<br /> sunspot/lib/sunspot/search/more_like_this_search.rb,<br /> sunspot_rails/lib/sunspot/rails/request_lifecycle.rb,<br /> sunspot_rails/lib/sunspot/rails/stub_session_proxy.rb,<br /> sunspot_solr/lib/sunspot/solr/installer/task_helper.rb,<br /> sunspot_rails/lib/sunspot/rails/solr_instrumentation.rb,<br /> sunspot/lib/sunspot/session_proxy/sharding_session_proxy.rb,<br /> sunspot/lib/sunspot/session_proxy/abstract_session_proxy.rb,<br /> sunspot_solr/lib/sunspot/solr/installer/config_installer.rb,<br /> sunspot/lib/sunspot/session_proxy/id_sharding_session_proxy.rb,<br /> sunspot_rails/lib/sunspot/rails/railties/controller_runtime.rb,<br /> sunspot/lib/sunspot/session_proxy/silent_fail_session_proxy.rb,<br /> sunspot/lib/sunspot/session_proxy/master_slave_session_proxy.rb,<br /> sunspot/lib/sunspot/session_proxy/thread_local_session_proxy.rb,<br /> sunspot/lib/sunspot/session_proxy/class_sharding_session_proxy.rb</span>
</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>
The Sunspot module provides class-method entry points to most of the
functionality provided by the Sunspot library. Internally, the Sunspot
singleton class contains a (non-thread-safe!) instance of Sunspot::Session,
to which it delegates most of the class methods it exposes. In the method
documentation below, this instance is referred to as the &#8220;singleton
session&#8221;.
</p>
<p>
Though the singleton session provides a convenient entry point to Sunspot,
it is by no means required to use the Sunspot class methods. Multiple
sessions may be instantiated and used (if you need to connect to multiple
Solr instances, for example.)
</p>
<p>
Note that the configuration of classes for index/search (the <tt>setup</tt>
method) is <em>not</em> session-specific, but rather global.
</p>


  </div>
</div>
<div class="tags">
  

</div><h2>Defined Under Namespace</h2>
<p class="children">
   
    
      <strong class="modules">Modules:</strong> <span class='object_link'><a href="Sunspot/Adapters.html" title="Sunspot::Adapters (module)">Adapters</a></span>, <span class='object_link'><a href="Sunspot/Configuration.html" title="Sunspot::Configuration (module)">Configuration</a></span>, <span class='object_link'><a href="Sunspot/DSL.html" title="Sunspot::DSL (module)">DSL</a></span>, <span class='object_link'><a href="Sunspot/DataExtractor.html" title="Sunspot::DataExtractor (module)">DataExtractor</a></span>, <span class='object_link'><a href="Sunspot/FieldFactory.html" title="Sunspot::FieldFactory (module)">FieldFactory</a></span>, <span class='object_link'><a href="Sunspot/Query.html" title="Sunspot::Query (module)">Query</a></span>, <span class='object_link'><a href="Sunspot/Rails.html" title="Sunspot::Rails (module)">Rails</a></span>, <span class='object_link'><a href="Sunspot/Search.html" title="Sunspot::Search (module)">Search</a></span>, <span class='object_link'><a href="Sunspot/SessionProxy.html" title="Sunspot::SessionProxy (module)">SessionProxy</a></span>, <span class='object_link'><a href="Sunspot/Solr.html" title="Sunspot::Solr (module)">Solr</a></span>, <span class='object_link'><a href="Sunspot/Type.html" title="Sunspot::Type (module)">Type</a></span>, <span class='object_link'><a href="Sunspot/Util.html" title="Sunspot::Util (module)">Util</a></span>
    
   
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="Sunspot/AttributeField.html" title="Sunspot::AttributeField (class)">AttributeField</a></span>, <span class='object_link'><a href="Sunspot/ClassSet.html" title="Sunspot::ClassSet (class)">ClassSet</a></span>, <span class='object_link'><a href="Sunspot/CompositeSetup.html" title="Sunspot::CompositeSetup (class)">CompositeSetup</a></span>, <span class='object_link'><a href="Sunspot/Field.html" title="Sunspot::Field (class)">Field</a></span>, <span class='object_link'><a href="Sunspot/FulltextField.html" title="Sunspot::FulltextField (class)">FulltextField</a></span>, <span class='object_link'><a href="Sunspot/IdField.html" title="Sunspot::IdField (class)">IdField</a></span>, <span class='object_link'><a href="Sunspot/Indexer.html" title="Sunspot::Indexer (class)">Indexer</a></span>, <span class='object_link'><a href="Sunspot/Schema.html" title="Sunspot::Schema (class)">Schema</a></span>, <span class='object_link'><a href="Sunspot/Session.html" title="Sunspot::Session (class)">Session</a></span>, <span class='object_link'><a href="Sunspot/Setup.html" title="Sunspot::Setup (class)">Setup</a></span>, <span class='object_link'><a href="Sunspot/TextFieldSetup.html" title="Sunspot::TextFieldSetup (class)">TextFieldSetup</a></span>, <span class='object_link'><a href="Sunspot/TypeField.html" title="Sunspot::TypeField (class)">TypeField</a></span>
    
  
</p>

  <h2>Constant Summary</h2>
  
    <dl class="constants">
      
        <dt id="UnrecognizedFieldError-constant" class="">UnrecognizedFieldError =
          
        </dt>
        <dd><pre class="code"><span class='const'>Class</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='const'>StandardError</span><span class='rparen'>)</span></pre></dd>
      
        <dt id="UnrecognizedRestrictionError-constant" class="">UnrecognizedRestrictionError =
          
        </dt>
        <dd><pre class="code"><span class='const'>Class</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='const'>StandardError</span><span class='rparen'>)</span></pre></dd>
      
        <dt id="NoAdapterError-constant" class="">NoAdapterError =
          
        </dt>
        <dd><pre class="code"><span class='const'>Class</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='const'>StandardError</span><span class='rparen'>)</span></pre></dd>
      
        <dt id="NoSetupError-constant" class="">NoSetupError =
          
        </dt>
        <dd><pre class="code"><span class='const'>Class</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='const'>StandardError</span><span class='rparen'>)</span></pre></dd>
      
        <dt id="IllegalSearchError-constant" class="">IllegalSearchError =
          
        </dt>
        <dd><pre class="code"><span class='const'>Class</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='const'>StandardError</span><span class='rparen'>)</span></pre></dd>
      
        <dt id="NotImplementedError-constant" class="">NotImplementedError =
          
        </dt>
        <dd><pre class="code"><span class='const'>Class</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='const'>StandardError</span><span class='rparen'>)</span></pre></dd>
      
        <dt id="VERSION-constant" class="">VERSION =
          
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>1.3.0.rc7</span><span class='tstring_end'>'</span></span></pre></dd>
      
    </dl>
  


  <h2>Class Attribute Summary <small>(<a href="#" class="summary_toggle">collapse</a>)</small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#searchable-class_method" title="searchable (class method)">+ (Object) <strong>searchable</strong> </a>
    

    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Access the list of classes set up to be searched.
</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#session-class_method" title="session (class method)">+ (Object) <strong>session</strong> </a>
    

    
  </span>
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Get the singleton session, creating it if none yet exists.
</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#batch-class_method" title="batch (class method)">+ (Object) <strong>batch</strong>(&amp;block) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Process all adds in a batch.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#commit-class_method" title="commit (class method)">+ (Object) <strong>commit</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Commits the singleton session.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#commit_if_delete_dirty-class_method" title="commit_if_delete_dirty (class method)">+ (Object) <strong>commit_if_delete_dirty</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Sends a commit if the session has deletes since the last commit (see
#delete_dirty?).
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#commit_if_dirty-class_method" title="commit_if_dirty (class method)">+ (Object) <strong>commit_if_dirty</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Sends a commit if the session is dirty (see #dirty?).
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#config-class_method" title="config (class method)">+ (Object) <strong>config</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns the configuration associated with the singleton session.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#delete_dirty%3F-class_method" title="delete_dirty? (class method)">+ (Boolean) <strong>delete_dirty?</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
True if documents have been removed since the last commit.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#dirty%3F-class_method" title="dirty? (class method)">+ (Boolean) <strong>dirty?</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
True if documents have been added, updated, or removed since the last
commit.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#index-class_method" title="index (class method)">+ (Object) <strong>index</strong>(*objects) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Indexes objects on the singleton session.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#index%21-class_method" title="index! (class method)">+ (Object) <strong>index!</strong>(*objects) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Indexes objects on the singleton session and commits immediately.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#more_like_this-class_method" title="more_like_this (class method)">+ (Object) <strong>more_like_this</strong>(object, *types, &amp;block) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Initiate a MoreLikeThis search.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#new_more_like_this-class_method" title="new_more_like_this (class method)">+ (Object) <strong>new_more_like_this</strong>(object, *types, &amp;block) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#new_search-class_method" title="new_search (class method)">+ (Object) <strong>new_search</strong>(*types, &amp;block) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Create a new Search instance, but do not execute it immediately.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#optimize-class_method" title="optimize (class method)">+ (Object) <strong>optimize</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Optimizes the index on the singletion session.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#remove-class_method" title="remove (class method)">+ (Object) <strong>remove</strong>(*objects, &amp;block) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Remove objects from the index.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#remove%21-class_method" title="remove! (class method)">+ (Object) <strong>remove!</strong>(*objects) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Remove objects from the index and immediately commit.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#remove_all-class_method" title="remove_all (class method)">+ (Object) <strong>remove_all</strong>(*classes) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Remove all objects of the given classes from the index.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#remove_all%21-class_method" title="remove_all! (class method)">+ (Object) <strong>remove_all!</strong>(*classes) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Remove all objects of the given classes from the index and immediately
commit.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#remove_by_id-class_method" title="remove_by_id (class method)">+ (Object) <strong>remove_by_id</strong>(clazz, id) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Remove an object from the index using its class name and primary key.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#remove_by_id%21-class_method" title="remove_by_id! (class method)">+ (Object) <strong>remove_by_id!</strong>(clazz, id) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Remove an object by class name and primary key, and immediately commit.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#reset%21-class_method" title="reset! (class method)">+ (Object) <strong>reset!</strong>(keep_config = false) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Resets the singleton session.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#search-class_method" title="search (class method)">+ (Object) <strong>search</strong>(*types, &amp;block) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Search for objects in the index.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#setup-class_method" title="setup (class method)">+ (Object) <strong>setup</strong>(clazz, &amp;block) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Configures indexing and search for a given class.
</p>
</div></span>
  
</li>

      
    </ul>
  


  <div id="class_attr_details" class="attr_details">
    <h2>Class Attribute Details</h2>
    
      
      <span id=""></span>
      <span id="searchable-class_method"></span>
      <div class="method_details first">
  <p class="signature first" id="searchable-class_method">
  
    + (<tt>Object</tt>) <strong>searchable</strong>  <span class="extras">(readonly)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Access the list of classes set up to be searched.
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


62
63
64</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'sunspot/lib/sunspot.rb', line 62</span>

<span class='kw'>def</span> <span class='id searchable'>searchable</span>
  <span class='ivar'>@searchable</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="session=-class_method"></span>
      <span id="session-class_method"></span>
      <div class="method_details ">
  <p class="signature " id="session-class_method">
  
    + (<tt>Object</tt>) <strong>session</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Get the singleton session, creating it if none yet exists.
</p>
<h4>Returns</h4>
<table>
<tr><td valign="top">Sunspot::Session</td><td><p>
the singleton session
</p>
</td></tr>
</table>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


575
576
577</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'sunspot/lib/sunspot.rb', line 575</span>

<span class='kw'>def</span> <span class='id session'>session</span> <span class='comment'>#:nodoc:
</span>  <span class='ivar'>@session</span> <span class='op'>||=</span> <span class='const'>Session</span><span class='period'>.</span><span class='id new'>new</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="batch-class_method">
  
    + (<tt>Object</tt>) <strong>batch</strong>(&amp;block) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Process all adds in a batch. Any Sunspot adds initiated inside the block
will be sent in bulk when the block finishes. Useful if your application
initiates index adds from various places in code as part of a single
operation; doing a batch add will give better performance.
</p>
<h4>Example</h4>
<pre class="code">
  <span class='const'>Sunspot</span><span class='period'>.</span><span class='id batch'>batch</span> <span class='kw'>do</span>
    <span class='id post'>post</span> <span class='op'>=</span> <span class='const'>Post</span><span class='period'>.</span><span class='id new'>new</span>
    <span class='const'>Sunspot</span><span class='period'>.</span><span class='id add'>add</span><span class='lparen'>(</span><span class='id post'>post</span><span class='rparen'>)</span>
    <span class='id comment'>comment</span> <span class='op'>=</span> <span class='const'>Comment</span><span class='period'>.</span><span class='id new'>new</span>
    <span class='const'>Sunspot</span><span class='period'>.</span><span class='id add'>add</span><span class='lparen'>(</span><span class='id comment'>comment</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
</pre>
<p>
Sunspot will send both the post and the comment in a single request.
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


496
497
498</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'sunspot/lib/sunspot.rb', line 496</span>

<span class='kw'>def</span> <span class='id batch'>batch</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id block'>block</span><span class='rparen'>)</span>
  <span class='id session'>session</span><span class='period'>.</span><span class='id batch'>batch</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id block'>block</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="commit-class_method">
  
    + (<tt>Object</tt>) <strong>commit</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Commits the singleton session
</p>
<p>
When documents are added to or removed from Solr, the changes are initially
stored in memory, and are not reflected in Solr&#8217;s existing searcher
instance. When a commit message is sent, the changes are written to disk,
and a new searcher is spawned. Commits are thus fairly expensive, so if
your application needs to index several documents as part of a single
operation, it is advisable to index them all and then call commit at the
end of the operation.
</p>
<p>
Note that Solr can also be configured to automatically perform a commit
after either a specified interval after the last change, or after a
specified number of documents are added. See <a
href="http://wiki.apache.org/solr/SolrConfigXml">wiki.apache.org/solr/SolrConfigXml</a>
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


214
215
216</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'sunspot/lib/sunspot.rb', line 214</span>

<span class='kw'>def</span> <span class='id commit'>commit</span>
  <span class='id session'>session</span><span class='period'>.</span><span class='id commit'>commit</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="commit_if_delete_dirty-class_method">
  
    + (<tt>Object</tt>) <strong>commit_if_delete_dirty</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Sends a commit if the session has deletes since the last commit (see
#delete_dirty?).
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


533
534
535</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'sunspot/lib/sunspot.rb', line 533</span>

<span class='kw'>def</span> <span class='id commit_if_delete_dirty'>commit_if_delete_dirty</span>
  <span class='id session'>session</span><span class='period'>.</span><span class='id commit_if_delete_dirty'>commit_if_delete_dirty</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="commit_if_dirty-class_method">
  
    + (<tt>Object</tt>) <strong>commit_if_dirty</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Sends a commit if the session is dirty (see #dirty?).
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


515
516
517</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'sunspot/lib/sunspot.rb', line 515</span>

<span class='kw'>def</span> <span class='id commit_if_dirty'>commit_if_dirty</span>
  <span class='id session'>session</span><span class='period'>.</span><span class='id commit_if_dirty'>commit_if_dirty</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="config-class_method">
  
    + (<tt>Object</tt>) <strong>config</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns the configuration associated with the singleton session. See
Sunspot::Configuration for details.
</p>
<h4>Returns</h4>
<table>
<tr><td valign="top">LightConfig::Configuration</td><td><p>
configuration for singleton session
</p>
</td></tr>
</table>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


544
545
546</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'sunspot/lib/sunspot.rb', line 544</span>

<span class='kw'>def</span> <span class='id config'>config</span>
  <span class='id session'>session</span><span class='period'>.</span><span class='id config'>config</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="delete_dirty?-class_method">
  
    + (<tt>Boolean</tt>) <strong>delete_dirty?</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
True if documents have been removed since the last commit.
</p>
<h4>Returns</h4>
<table>
<tr><td valign="top">Boolean</td><td><p>
Whether there have been any deletes since the last commit
</p>
</td></tr>
</table>


  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


526
527
528</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'sunspot/lib/sunspot.rb', line 526</span>

<span class='kw'>def</span> <span class='id delete_dirty?'>delete_dirty?</span>
  <span class='id session'>session</span><span class='period'>.</span><span class='id delete_dirty?'>delete_dirty?</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="dirty?-class_method">
  
    + (<tt>Boolean</tt>) <strong>dirty?</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
True if documents have been added, updated, or removed since the last
commit.
</p>
<h4>Returns</h4>
<table>
<tr><td valign="top">Boolean</td><td><p>
Whether there have been any updates since the last commit
</p>
</td></tr>
</table>


  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


508
509
510</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'sunspot/lib/sunspot.rb', line 508</span>

<span class='kw'>def</span> <span class='id dirty?'>dirty?</span>
  <span class='id session'>session</span><span class='period'>.</span><span class='id dirty?'>dirty?</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="index-class_method">
  
    + (<tt>Object</tt>) <strong>index</strong>(*objects) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Indexes objects on the singleton session.
</p>
<h4>Parameters</h4>
<table>
<tr><td valign="top">objects&#8230;<Object></td><td><p>
objects to index (may pass an array or varargs)
</p>
</td></tr>
</table>
<h4>Example</h4>
<pre class="code">
  <span class='id post1'>post1</span><span class='comma'>,</span> <span class='id post2'>post2</span> <span class='op'>=</span> <span class='id new'>new</span> <span class='const'>Array</span><span class='lparen'>(</span><span class='int'>2</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='const'>Post</span><span class='period'>.</span><span class='id create'>create</span> <span class='rbrace'>}</span>
  <span class='const'>Sunspot</span><span class='period'>.</span><span class='id index'>index</span><span class='lparen'>(</span><span class='id post1'>post1</span><span class='comma'>,</span> <span class='id post2'>post2</span><span class='rparen'>)</span>
</pre>
<p>
Note that indexed objects won&#8217;t be reflected in search until a commit
is sent - see Sunspot.index! and Sunspot.commit
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


183
184
185</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'sunspot/lib/sunspot.rb', line 183</span>

<span class='kw'>def</span> <span class='id index'>index</span><span class='lparen'>(</span><span class='op'>*</span><span class='id objects'>objects</span><span class='rparen'>)</span>
  <span class='id session'>session</span><span class='period'>.</span><span class='id index'>index</span><span class='lparen'>(</span><span class='op'>*</span><span class='id objects'>objects</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="index!-class_method">
  
    + (<tt>Object</tt>) <strong>index!</strong>(*objects) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Indexes objects on the singleton session and commits immediately.
</p>
<p>
See: Sunspot.index and Sunspot.commit
</p>
<h4>Parameters</h4>
<table>
<tr><td valign="top">objects&#8230;<Object></td><td><p>
objects to index (may pass an array or varargs)
</p>
</td></tr>
</table>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


195
196
197</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'sunspot/lib/sunspot.rb', line 195</span>

<span class='kw'>def</span> <span class='id index!'>index!</span><span class='lparen'>(</span><span class='op'>*</span><span class='id objects'>objects</span><span class='rparen'>)</span>
  <span class='id session'>session</span><span class='period'>.</span><span class='id index!'>index!</span><span class='lparen'>(</span><span class='op'>*</span><span class='id objects'>objects</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="more_like_this-class_method">
  
    + (<tt>Object</tt>) <strong>more_like_this</strong>(object, *types, &amp;block) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Initiate a MoreLikeThis search. MoreLikeThis is a special type of search
that finds similar documents using fulltext comparison. The fields to be
compared are `text` fields set up with the `:more_like_this` option set to
`true`. By default, more like this returns objects of the same type as the
object used for comparison, but a list of types can optionally be passed to
this method to return similar documents of other types. This will only work
for types that have common fields.
</p>
<p>
The DSL for MoreLikeThis search exposes several methods for setting options
specific to this type of search. See the Sunspot::DSL::MoreLikeThis class
and the MoreLikeThis documentation on the Solr wiki: <a
href="http://wiki.apache.org/solr/MoreLikeThis">wiki.apache.org/solr/MoreLikeThis</a>
</p>
<p>
MoreLikeThis searches have all of the same scoping, ordering, and faceting
functionality as standard searches; the only thing you can&#8217;t do in a
MLT search is fulltext matching (since the MLT itself is a fulltext query).
</p>
<h4>Example</h4>
<pre class="code">
  <span class='id post'>post</span> <span class='op'>=</span> <span class='const'>Post</span><span class='period'>.</span><span class='id first'>first</span>
  <span class='const'>Sunspot</span><span class='period'>.</span><span class='id more_like_this'>more_like_this</span><span class='lparen'>(</span><span class='id post'>post</span><span class='comma'>,</span> <span class='const'>Post</span><span class='comma'>,</span> <span class='const'>Page</span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='id fields'>fields</span> <span class='symbol'>:title</span><span class='comma'>,</span> <span class='symbol'>:body</span>
    <span class='id with'>with</span><span class='lparen'>(</span><span class='symbol'>:updated_at</span><span class='rparen'>)</span><span class='period'>.</span><span class='id greater_than'>greater_than</span><span class='lparen'>(</span><span class='int'>1</span><span class='period'>.</span><span class='id month'>month</span><span class='period'>.</span><span class='id ago'>ago</span><span class='rparen'>)</span>
    <span class='id facet'>facet</span><span class='lparen'>(</span><span class='symbol'>:category_ids</span><span class='rparen'>)</span>
  <span class='kw'>end</span></pre>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


380
381
382</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'sunspot/lib/sunspot.rb', line 380</span>

<span class='kw'>def</span> <span class='id more_like_this'>more_like_this</span><span class='lparen'>(</span><span class='id object'>object</span><span class='comma'>,</span> <span class='op'>*</span><span class='id types'>types</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id block'>block</span><span class='rparen'>)</span>
  <span class='id session'>session</span><span class='period'>.</span><span class='id more_like_this'>more_like_this</span><span class='lparen'>(</span><span class='id object'>object</span><span class='comma'>,</span> <span class='op'>*</span><span class='id types'>types</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id block'>block</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="new_more_like_this-class_method">
  
    + (<tt>Object</tt>) <strong>new_more_like_this</strong>(object, *types, &amp;block) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


348
349
350</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'sunspot/lib/sunspot.rb', line 348</span>

<span class='kw'>def</span> <span class='id new_more_like_this'>new_more_like_this</span><span class='lparen'>(</span><span class='id object'>object</span><span class='comma'>,</span> <span class='op'>*</span><span class='id types'>types</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id block'>block</span><span class='rparen'>)</span>
  <span class='id session'>session</span><span class='period'>.</span><span class='id new_more_like_this'>new_more_like_this</span><span class='lparen'>(</span><span class='id object'>object</span><span class='comma'>,</span> <span class='op'>*</span><span class='id types'>types</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id block'>block</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="new_search-class_method">
  
    + (<tt>Object</tt>) <strong>new_search</strong>(*types, &amp;block) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Create a new Search instance, but do not execute it immediately. Generally
you will want to use the #search method to build and execute searches in
one step, but if you are building searches piecemeal you may call
#new_search and then call #build one or more times to add components to the
query.
</p>
<h4>Example</h4>
<pre class="code">
  <span class='id search'>search</span> <span class='op'>=</span> <span class='const'>Sunspot</span><span class='period'>.</span><span class='id new_search'>new_search</span> <span class='kw'>do</span>
    <span class='id with'>with</span><span class='lparen'>(</span><span class='symbol'>:blog_id</span><span class='comma'>,</span> <span class='int'>1</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id search'>search</span><span class='period'>.</span><span class='id build'>build</span> <span class='kw'>do</span>
    <span class='id keywords'>keywords</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>some keywords</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id search'>search</span><span class='period'>.</span><span class='id build'>build</span> <span class='kw'>do</span>
    <span class='id order_by'>order_by</span><span class='lparen'>(</span><span class='symbol'>:published_at</span><span class='comma'>,</span> <span class='symbol'>:desc</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id search'>search</span><span class='period'>.</span><span class='id execute'>execute</span>

  <span class='comment'># This is equivalent to:
</span>  <span class='const'>Sunspot</span><span class='period'>.</span><span class='id search'>search</span> <span class='kw'>do</span>
    <span class='id with'>with</span><span class='lparen'>(</span><span class='symbol'>:blog_id</span><span class='comma'>,</span> <span class='int'>1</span><span class='rparen'>)</span>
    <span class='id keywords'>keywords</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>some keywords</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
    <span class='id order_by'>order_by</span><span class='lparen'>(</span><span class='symbol'>:published_at</span><span class='comma'>,</span> <span class='symbol'>:desc</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
</pre>
<h4>Parameters</h4>
<table>
<tr><td valign="top">types<Class>&#8230;</td><td><p>
One or more types to search for. If no types are passed, all configured
types will be searched for.
</p>
</td></tr>
</table>
<h4>Returns</h4>
<table>
<tr><td valign="top">Sunspot::Search</td><td><p>
Search object, not yet executed. Query parameters can be added manually;
then #execute should be called.
</p>
</td></tr>
</table>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


269
270
271</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'sunspot/lib/sunspot.rb', line 269</span>

<span class='kw'>def</span> <span class='id new_search'>new_search</span><span class='lparen'>(</span><span class='op'>*</span><span class='id types'>types</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id block'>block</span><span class='rparen'>)</span>
  <span class='id session'>session</span><span class='period'>.</span><span class='id new_search'>new_search</span><span class='lparen'>(</span><span class='op'>*</span><span class='id types'>types</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id block'>block</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="optimize-class_method">
  
    + (<tt>Object</tt>) <strong>optimize</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Optimizes the index on the singletion session.
</p>
<p>
Frequently adding and deleting documents to Solr, leaves the index in a
fragmented state. The optimize command merges all index segments into  a
single segment and removes any deleted documents, making it faster to 
search. Since optimize rebuilds the index from scratch, it takes some  time
and requires double the space on the hard disk while it&#8217;s rebuilding.
Note that optimize also commits.
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


226
227
228</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'sunspot/lib/sunspot.rb', line 226</span>

<span class='kw'>def</span> <span class='id optimize'>optimize</span>
  <span class='id session'>session</span><span class='period'>.</span><span class='id optimize'>optimize</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="remove-class_method">
  
    + (<tt>Object</tt>) <strong>remove</strong>(*objects, &amp;block) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Remove objects from the index. Any time an object is destroyed, it must be
removed from the index; otherwise, the index will contain broken references
to objects that do not exist, which will cause errors when those objects
are matched in search results.
</p>
<p>
If a block is passed, it is evaluated as a search scope; in this way,
documents can be removed by an arbitrary query. In this case, the arguments
to the method should be the classes to run the query on.
</p>
<h4>Parameters</h4>
<table>
<tr><td valign="top">objects&#8230;<Object></td><td><p>
Objects to remove from the index (may pass an array or varargs)
</p>
</td></tr>
</table>
<h4>Example (remove a document)</h4>
<pre class="code">
  <span class='id post'>post</span><span class='period'>.</span><span class='id destroy'>destroy</span>
  <span class='const'>Sunspot</span><span class='period'>.</span><span class='id remove'>remove</span><span class='lparen'>(</span><span class='id post'>post</span><span class='rparen'>)</span>
</pre>
<h4>Example (remove by query)</h4>
<pre class="code">
  <span class='const'>Sunspot</span><span class='period'>.</span><span class='id remove'>remove</span><span class='lparen'>(</span><span class='const'>Post</span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='id with'>with</span><span class='lparen'>(</span><span class='symbol'>:created_at</span><span class='rparen'>)</span><span class='period'>.</span><span class='id less_than'>less_than</span><span class='lparen'>(</span><span class='const'>Time</span><span class='period'>.</span><span class='id now'>now</span> <span class='op'>-</span> <span class='int'>14</span><span class='period'>.</span><span class='id days'>days</span><span class='rparen'>)</span>
  <span class='kw'>end</span></pre>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


409
410
411</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'sunspot/lib/sunspot.rb', line 409</span>

<span class='kw'>def</span> <span class='id remove'>remove</span><span class='lparen'>(</span><span class='op'>*</span><span class='id objects'>objects</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id block'>block</span><span class='rparen'>)</span>
  <span class='id session'>session</span><span class='period'>.</span><span class='id remove'>remove</span><span class='lparen'>(</span><span class='op'>*</span><span class='id objects'>objects</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id block'>block</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="remove!-class_method">
  
    + (<tt>Object</tt>) <strong>remove!</strong>(*objects) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Remove objects from the index and immediately commit. See Sunspot.remove
</p>
<h4>Parameters</h4>
<table>
<tr><td valign="top">objects&#8230;<Object></td><td><p>
Objects to remove from the index
</p>
</td></tr>
</table>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


420
421
422</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'sunspot/lib/sunspot.rb', line 420</span>

<span class='kw'>def</span> <span class='id remove!'>remove!</span><span class='lparen'>(</span><span class='op'>*</span><span class='id objects'>objects</span><span class='rparen'>)</span>
  <span class='id session'>session</span><span class='period'>.</span><span class='id remove!'>remove!</span><span class='lparen'>(</span><span class='op'>*</span><span class='id objects'>objects</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="remove_all-class_method">
  
    + (<tt>Object</tt>) <strong>remove_all</strong>(*classes) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Remove all objects of the given classes from the index. There isn&#8217;t
much use for this in general operations but it can be useful for
maintenance, testing, etc. If no arguments are passed, remove everything
from the index.
</p>
<h4>Parameters</h4>
<table>
<tr><td valign="top">classes&#8230;<Class></td><td><p>
classes for which to remove all instances from the index (may pass an array
or varargs)
</p>
</td></tr>
</table>
<h4>Example</h4>
<pre class="code">
  <span class='const'>Sunspot</span><span class='period'>.</span><span class='id remove_all'>remove_all</span><span class='lparen'>(</span><span class='const'>Post</span><span class='comma'>,</span> <span class='const'>Blog</span><span class='rparen'>)</span></pre>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


463
464
465</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'sunspot/lib/sunspot.rb', line 463</span>

<span class='kw'>def</span> <span class='id remove_all'>remove_all</span><span class='lparen'>(</span><span class='op'>*</span><span class='id classes'>classes</span><span class='rparen'>)</span>
  <span class='id session'>session</span><span class='period'>.</span><span class='id remove_all'>remove_all</span><span class='lparen'>(</span><span class='op'>*</span><span class='id classes'>classes</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="remove_all!-class_method">
  
    + (<tt>Object</tt>) <strong>remove_all!</strong>(*classes) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Remove all objects of the given classes from the index and immediately
commit. See Sunspot.remove_all
</p>
<h4>Parameters</h4>
<table>
<tr><td valign="top">classes&#8230;<Class></td><td><p>
classes for which to remove all instances from the index
</p>
</td></tr>
</table>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


475
476
477</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'sunspot/lib/sunspot.rb', line 475</span>

<span class='kw'>def</span> <span class='id remove_all!'>remove_all!</span><span class='lparen'>(</span><span class='op'>*</span><span class='id classes'>classes</span><span class='rparen'>)</span>
  <span class='id session'>session</span><span class='period'>.</span><span class='id remove_all!'>remove_all!</span><span class='lparen'>(</span><span class='op'>*</span><span class='id classes'>classes</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="remove_by_id-class_method">
  
    + (<tt>Object</tt>) <strong>remove_by_id</strong>(clazz, id) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Remove an object from the index using its class name and primary key.
Useful if you know this information and want to remove an object without
instantiating it from persistent storage
</p>
<h4>Parameters</h4>
<table>
<tr><td valign="top">clazz<Class></td><td><p>
Class of the object, or class name as a string or symbol
</p>
</td></tr>
<tr><td valign="top">id</td><td><p>
Primary key of the object. This should be the same id that would be
returned by the class&#8217;s instance adapter.
</p>
</td></tr>
</table>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


436
437
438</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'sunspot/lib/sunspot.rb', line 436</span>

<span class='kw'>def</span> <span class='id remove_by_id'>remove_by_id</span><span class='lparen'>(</span><span class='id clazz'>clazz</span><span class='comma'>,</span> <span class='id id'>id</span><span class='rparen'>)</span>
  <span class='id session'>session</span><span class='period'>.</span><span class='id remove_by_id'>remove_by_id</span><span class='lparen'>(</span><span class='id clazz'>clazz</span><span class='comma'>,</span> <span class='id id'>id</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="remove_by_id!-class_method">
  
    + (<tt>Object</tt>) <strong>remove_by_id!</strong>(clazz, id) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Remove an object by class name and primary key, and immediately commit. See
#remove_by_id and #commit
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


444
445
446</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'sunspot/lib/sunspot.rb', line 444</span>

<span class='kw'>def</span> <span class='id remove_by_id!'>remove_by_id!</span><span class='lparen'>(</span><span class='id clazz'>clazz</span><span class='comma'>,</span> <span class='id id'>id</span><span class='rparen'>)</span>
  <span class='id session'>session</span><span class='period'>.</span><span class='id remove_by_id!'>remove_by_id!</span><span class='lparen'>(</span><span class='id clazz'>clazz</span><span class='comma'>,</span> <span class='id id'>id</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="reset!-class_method">
  
    + (<tt>Object</tt>) <strong>reset!</strong>(keep_config = false) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Resets the singleton session. This is useful for clearing out all static
data between tests, but probably nowhere else.
</p>
<h4>Parameters</h4>
<table>
<tr><td valign="top">keep_config<Boolean></td><td><p>
Whether to retain the configuration used by the current singleton session.
Default false.
</p>
</td></tr>
</table>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


558
559
560
561
562
563
564
565
566</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'sunspot/lib/sunspot.rb', line 558</span>

<span class='kw'>def</span> <span class='id reset!'>reset!</span><span class='lparen'>(</span><span class='id keep_config'>keep_config</span> <span class='op'>=</span> <span class='kw'>false</span><span class='rparen'>)</span>
  <span class='id config'>config</span> <span class='op'>=</span>
    <span class='kw'>if</span> <span class='id keep_config'>keep_config</span>
      <span class='id session'>session</span><span class='period'>.</span><span class='id config'>config</span>
    <span class='kw'>else</span>
      <span class='const'>Configuration</span><span class='period'>.</span><span class='id build'>build</span>
    <span class='kw'>end</span>
  <span class='ivar'>@session</span> <span class='op'>=</span> <span class='const'>Session</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='id config'>config</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="search-class_method">
  
    + (<tt>Object</tt>) <strong>search</strong>(*types, &amp;block) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Search for objects in the index.
</p>
<h4>Parameters</h4>
<table>
<tr><td valign="top">types<Class>&#8230;</td><td><p>
One or more types to search for. If no types are passed, all configured
types will be searched.
</p>
</td></tr>
</table>
<h4>Returns</h4>
<table>
<tr><td valign="top">Sunspot::Search</td><td><p>
Object containing results, facets, count, etc.
</p>
</td></tr>
</table>
<p>
The fields available for restriction, ordering, etc. are those that meet
the following criteria:
</p>
<ul>
<li><p>
They are not of type <tt>text</tt>.
</p>
</li>
<li><p>
They are defined for at least one of the classes being searched
</p>
</li>
<li><p>
They have the same data type for all of the classes being searched.
</p>
</li>
<li><p>
They have the same multiple flag for all of the classes being searched.
</p>
</li>
<li><p>
They have the same stored flag for all of the classes being searched.
</p>
</li>
</ul>
<p>
The restrictions available are the constants defined in the
Sunspot::Restriction class. The standard restrictions are:
</p>
<pre class="code">
  <span class='id with'>with</span><span class='lparen'>(</span><span class='symbol'>:field_name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id equal_to'>equal_to</span><span class='lparen'>(</span><span class='id value'>value</span><span class='rparen'>)</span>
  <span class='id with'>with</span><span class='lparen'>(</span><span class='symbol'>:field_name</span><span class='comma'>,</span> <span class='id value'>value</span><span class='rparen'>)</span> <span class='comment'># shorthand for above
</span>  <span class='id with'>with</span><span class='lparen'>(</span><span class='symbol'>:field_name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id less_than'>less_than</span><span class='lparen'>(</span><span class='id value'>value</span><span class='rparen'>)</span>
  <span class='id with'>with</span><span class='lparen'>(</span><span class='symbol'>:field_name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id greater_than'>greater_than</span><span class='lparen'>(</span><span class='id value'>value</span><span class='rparen'>)</span>
  <span class='id with'>with</span><span class='lparen'>(</span><span class='symbol'>:field_name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id between'>between</span><span class='lparen'>(</span><span class='id value1'>value1</span><span class='op'>..</span><span class='id value2'>value2</span><span class='rparen'>)</span>
  <span class='id with'>with</span><span class='lparen'>(</span><span class='symbol'>:field_name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id any_of'>any_of</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='id value1'>value1</span><span class='comma'>,</span> <span class='id value2'>value2</span><span class='comma'>,</span> <span class='id value3'>value3</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='id with'>with</span><span class='lparen'>(</span><span class='symbol'>:field_name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id all_of'>all_of</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='id value1'>value1</span><span class='comma'>,</span> <span class='id value2'>value2</span><span class='comma'>,</span> <span class='id value3'>value3</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='id without'>without</span><span class='lparen'>(</span><span class='id some_instance'>some_instance</span><span class='rparen'>)</span> <span class='comment'># exclude that particular instance
</span></pre>
<p>
<tt>without</tt> can be substituted for <tt>with</tt>, causing the
restriction to be negated. In the last example above, only <tt>without</tt>
works, as it does not make sense to search only for an instance you already
have.
</p>
<p>
Equality restrictions can take <tt>nil</tt> as a value, which restricts the
results to documents that have no value for the given field. Passing
<tt>nil</tt> as a value to other restriction types is illegal. Thus:
</p>
<pre class="code">
  <span class='id with'>with</span><span class='lparen'>(</span><span class='symbol'>:field_name</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='rparen'>)</span> <span class='comment'># ok
</span>  <span class='id with'>with</span><span class='lparen'>(</span><span class='symbol'>:field_name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id equal_to'>equal_to</span><span class='lparen'>(</span><span class='kw'>nil</span><span class='rparen'>)</span> <span class='comment'># ok
</span>  <span class='id with'>with</span><span class='lparen'>(</span><span class='symbol'>:field_name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id less_than'>less_than</span><span class='lparen'>(</span><span class='kw'>nil</span><span class='rparen'>)</span> <span class='comment'># bad
</span></pre>
<h4>Example</h4>
<pre class="code">
  <span class='const'>Sunspot</span><span class='period'>.</span><span class='id search'>search</span><span class='lparen'>(</span><span class='const'>Post</span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='id keywords'>keywords</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>great pizza</span><span class='tstring_end'>'</span></span>
    <span class='id with'>with</span><span class='lparen'>(</span><span class='symbol'>:published_at</span><span class='rparen'>)</span><span class='period'>.</span><span class='id less_than'>less_than</span> <span class='const'>Time</span><span class='period'>.</span><span class='id now'>now</span>
    <span class='id with'>with</span> <span class='symbol'>:blog_id</span><span class='comma'>,</span> <span class='int'>1</span>
    <span class='id without'>without</span> <span class='id current_post'>current_post</span>
    <span class='id facet'>facet</span> <span class='symbol'>:category_ids</span>
    <span class='id order_by'>order_by</span> <span class='symbol'>:published_at</span><span class='comma'>,</span> <span class='symbol'>:desc</span>
    <span class='id paginate'>paginate</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>15</span>
  <span class='kw'>end</span>
 
</pre>
<p>
If the block passed to #search takes an argument, that argument will
present the DSL, and the block will be evaluated in the calling context.
This will come in handy for building searches using instance data or
methods, e.g.:
</p>
<pre class="code">
  <span class='const'>Sunspot</span><span class='period'>.</span><span class='id search'>search</span><span class='lparen'>(</span><span class='const'>Post</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id query'>query</span><span class='op'>|</span>
    <span class='id query'>query</span><span class='period'>.</span><span class='id with'>with</span><span class='lparen'>(</span><span class='symbol'>:blog_id</span><span class='comma'>,</span> <span class='ivar'>@current_blog</span><span class='period'>.</span><span class='id id'>id</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
</pre>
<p>
See Sunspot::DSL::Search, Sunspot::DSL::Scope, Sunspot::DSL::FieldQuery and
Sunspot::DSL::StandardQuery for the full API presented inside the block.
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


344
345
346</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'sunspot/lib/sunspot.rb', line 344</span>

<span class='kw'>def</span> <span class='id search'>search</span><span class='lparen'>(</span><span class='op'>*</span><span class='id types'>types</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id block'>block</span><span class='rparen'>)</span>
  <span class='id session'>session</span><span class='period'>.</span><span class='id search'>search</span><span class='lparen'>(</span><span class='op'>*</span><span class='id types'>types</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id block'>block</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="setup-class_method">
  
    + (<tt>Object</tt>) <strong>setup</strong>(clazz, &amp;block) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Configures indexing and search for a given class.
</p>
<h4>Parameters</h4>
<table>
<tr><td valign="top">clazz<Class></td><td><p>
class to configure
</p>
</td></tr>
</table>
<h4>Example</h4>
<pre class="code">
  Sunspot.setup(Post) do
    text :title, :body
    string :author_name
    integer :blog_id
    integer :category_ids
    float :average_rating, :using =&gt; :ratings_average
    time :published_at
    string :sort_title do
      title.downcase.sub(/^(an?|the)\W+/, ''/) if title = self.title
    end
  end
</pre>
<h6>Attribute Fields vs. Virtual Fields</h6>
<p>
Attribute fields call a method on the indexed object and index the return
value. All of the fields defined above except for the last one are
attribute fields. By default, the field name will also be the attribute
used; this can be overriden with the <tt>:using</tt> option, as in
<tt>:average_rating</tt> above. In that case, the attribute
<tt>:ratings_average</tt> will be indexed with the field name
<tt>:average_rating</tt>.
</p>
<p>
<tt>:sort_title</tt> is a virtual field, which evaluates the block inside
the context of the instance being indexed, and indexes the value returned
by the block. If the block you pass takes an argument, it will be passed
the instance rather than being evaluated inside of it; so, the following
example is equivalent to the one above (assuming #title is public):
</p>
<pre class="code">
  Sunspot.setup(Post) do
    string :sort_title do |post|
      post.title.downcase.sub(/^(an?|the)\W+/, ''/) if title = self.title
    end
  end
</pre>
<h5>Field Types</h5>
<p>
The available types are:
</p>
<ul>
<li><p>
<tt>text</tt>
</p>
</li>
<li><p>
<tt>string</tt>
</p>
</li>
<li><p>
<tt>integer</tt>
</p>
</li>
<li><p>
<tt>float</tt>
</p>
</li>
<li><p>
<tt>time</tt>
</p>
</li>
<li><p>
<tt>boolean</tt>
</p>
</li>
</ul>
<p>
Note that the <tt>text</tt> type behaves quite differently from the others
- this is the type that is indexed as fulltext, and is searched using the
<tt>keywords</tt> method inside the search DSL. Text fields cannot have
restrictions set on them, nor can they be used in order statements or for
facets. All other types are indexed literally, and thus can be used for all
of those operations. They will not, however, be searched in fulltext. In
this way, Sunspot provides a complete barrier between fulltext fields and
value fields.
</p>
<p>
It is fine to specify a field both as a text field and a string field;
internally, the fields will have different names so there is no danger of
conflict.
</p>
<h5>Dynamic Fields</h5>
<p>
For use cases which have highly dynamic data models (for instance, an open
set of key-value pairs attached to a model), it may be useful to defer
definition of fields until indexing time. Sunspot exposes dynamic fields,
which define a data accessor (either attribute or virtual, see above),
which accepts a hash of field names to values. Note that the field names in
the hash are internally scoped to the base name of the dynamic field, so
any time they are referred to, they are referred to using both the base
name and the dynamic (runtime-specified) name.
</p>
<p>
Dynamic fields are speficied in the setup block using the type name
prefixed by <tt>dynamic_</tt>. For example:
</p>
<pre class="code">
  <span class='const'>Sunspot</span><span class='period'>.</span><span class='id setup'>setup</span><span class='lparen'>(</span><span class='const'>Post</span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='id dynamic_string'>dynamic_string</span> <span class='symbol'>:custom_values</span> <span class='kw'>do</span>
      <span class='id key_value_pairs'>key_value_pairs</span><span class='period'>.</span><span class='id inject'>inject</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id hash'>hash</span><span class='comma'>,</span> <span class='id key_value_pair'>key_value_pair</span><span class='op'>|</span>
        <span class='id hash'>hash</span><span class='lbracket'>[</span><span class='id key_value_pair'>key_value_pair</span><span class='period'>.</span><span class='id key'>key</span><span class='period'>.</span><span class='id to_sym'>to_sym</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id key_value_pair'>key_value_pair</span><span class='period'>.</span><span class='id value'>value</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
</pre>
<p>
If you later wanted to facet all of the values for the key
&#8220;cuisine&#8221;, you could issue:
</p>
<pre class="code">
  <span class='const'>Sunspot</span><span class='period'>.</span><span class='id search'>search</span><span class='lparen'>(</span><span class='const'>Post</span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='id dynamic'>dynamic</span> <span class='symbol'>:custom_values</span> <span class='kw'>do</span>
      <span class='id facet'>facet</span> <span class='symbol'>:cuisine</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
</pre>
<p>
In the documentation, <tt>:custom_values</tt> is referred to as the
&#8220;base name&#8221; - that is, the one specified statically - and
<tt>:cuisine</tt> is referred to as the dynamic name, which is the part
that is specified at indexing time.
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


164
165
166
167</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'sunspot/lib/sunspot.rb', line 164</span>

<span class='kw'>def</span> <span class='id setup'>setup</span><span class='lparen'>(</span><span class='id clazz'>clazz</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id block'>block</span><span class='rparen'>)</span>
  <span class='const'>Sunspot</span><span class='period'>.</span><span class='id searchable'>searchable</span> <span class='op'>&lt;&lt;</span> <span class='id clazz'>clazz</span>
  <span class='const'>Setup</span><span class='period'>.</span><span class='id setup'>setup</span><span class='lparen'>(</span><span class='id clazz'>clazz</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id block'>block</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    <div id="footer">
  Generated on Sat Nov 26 13:47:17 2011 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.7.3 (ruby-1.9.2).
</div>

  </body>
</html>
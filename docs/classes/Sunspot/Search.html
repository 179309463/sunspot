<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
  <head>
    <title>: Sunspot::Search [Sunspot - Pure-Ruby Solr Search and Indexing - API Documentation]</title>
    <meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
    <link href='../../rdoc-style.css' media='screen' rel='stylesheet' type='text/css'>
    <script type='text/javascript'>
      //<![CDATA[
        function popupCode(url) {
          window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
        }
        
        function toggleCode(id) {
          var code = document.getElementById(id)
        
          code.style.display = code.style.display != 'block' ? 'block' : 'none'
          return true
        }
        
        // Make codeblocks hidden by default
        document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
      //]]>
    </script>
  </head>
  <body class='page'>
    <div class='class' id='wrapper'>
      <div class='header'>
        <h1 class='name'>
          <span class='type'>Class</span>
          Sunspot::Search
        </h1>
        <ol class='paths'>
          <li>
            <a href="../../files/lib/sunspot/search_rb.html">lib/sunspot/search.rb</a>
            (<a href="http://github.com/outoftime/sunspot/tree/master/lib/sunspot/search.rb">view online</a>)
          </li>
        </ol>
        <div class='parent'>
          Parent:
          <strong>Object</strong>
        </div>
      </div>
      <div id='content'>
        <div id='text'>
          <div id='description'>
            <p>
            This class encapsulates the results of a Solr search. It provides access to
            search results, total result count, facets, and pagination information.
            Instances of <a href="Search.html">Search</a> are returned by the <a
            href="../Sunspot.html#M000006">Sunspot.search</a> method.
            </p>
          </div>
          <div id='method-list'>
            <h2>Methods</h2>
            <h3>public instance</h3>
            <ol>
              <li><a href="#M000051">facet</a></li>
              <li><a href="#M000049">raw_results</a></li>
              <li><a href="#M000048">results</a></li>
              <li><a href="#M000050">total</a></li>
            </ol>
          </div>
          <div id='section'>
            <div id='constants-list'>
              <h2>Constants</h2>
              <div class='name-list'>
                <table summary='Constants'>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>RawResult</td>
                    <td>=</td>
                    <td class='context-item-value'>Struct.new(:class_name, :primary_key)</td>
                  </tr>
                </table>
              </div>
            </div>
            <div id='attribute-list'>
              <h2 class='section-bar'>Attributes</h2>
              <div class='name-list'>
                <table>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>query</td>
                    <td class='context-item-value'>[R]</td>
                    <td class='context-item-desc'></td>
                  </tr>
                </table>
              </div>
            </div>
            <div id='methods'>
              <h2>Public instance methods</h2>
              <div class='public-instance method' id='method-M000051'>
                <a name='M000051'>      </a>
                <div class='synopsis'>
                  <span class='name'>facet</span>
                  <span class='arguments'>(field_name)</span>
                </div>
                <div class='description'>
                  <p>
                  Get the facet object for the given field. This field will need to have been
                  requested as a field facet inside the search block.
                  </p>
                  <h4>Parameters</h4>
                  <table>
                  <tr><td valign="top">field_name<Symbol>:</td><td>field name for which to get the facet
                  
                  </td></tr>
                  </table>
                  <h4>Returns</h4>
                  <table>
                  <tr><td valign="top">Sunspot::Facet:</td><td><a href="Facet.html">Facet</a> object for the given field
                  
                  </td></tr>
                  </table>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000051-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000051-source'><span class="ruby-comment cmt"># File lib/sunspot/search.rb, line 83</span>&#x000A;    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">facet</span>(<span class="ruby-identifier">field_name</span>)&#x000A;      (<span class="ruby-ivar">@facets_cache</span> <span class="ruby-operator">||=</span> {})[<span class="ruby-identifier">field_name</span>.<span class="ruby-identifier">to_sym</span>] <span class="ruby-operator">||=</span>&#x000A;        <span class="ruby-keyword kw">begin</span>&#x000A;          <span class="ruby-identifier">field</span> = <span class="ruby-ivar">@query</span>.<span class="ruby-identifier">field</span>(<span class="ruby-identifier">field_name</span>)&#x000A;          <span class="ruby-constant">Facet</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@solr_result</span>.<span class="ruby-identifier">field_facets</span>(<span class="ruby-identifier">field</span>.<span class="ruby-identifier">indexed_name</span>), <span class="ruby-identifier">field</span>)&#x000A;        <span class="ruby-keyword kw">end</span>&#x000A;    <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000049'>
                <a name='M000049'>      </a>
                <div class='synopsis'>
                  <span class='name'>raw_results</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <p>
                  Access raw results without instantiating objects from persistent storage.
                  This may be useful if you are using search as an intermediate step in data
                  retrieval. Returns an ordered collection of objects that respond to
                  class_name and primary_key
                  </p>
                  <h4>Returns</h4>
                  <table>
                  <tr><td valign="top">Array:</td><td>Ordered collection of raw results
                  
                  </td></tr>
                  </table>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000049-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000049-source'><span class="ruby-comment cmt"># File lib/sunspot/search.rb, line 56</span>&#x000A;    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">raw_results</span>&#x000A;      <span class="ruby-ivar">@raw_results</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">hit_ids</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">hit_id</span><span class="ruby-operator">|</span> <span class="ruby-constant">RawResult</span>.<span class="ruby-identifier">new</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">hit_id</span>.<span class="ruby-identifier">match</span>(<span class="ruby-regexp re">/([^ ]+) (.+)/</span>)[<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">2</span>]) }&#x000A;    <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000048'>
                <a name='M000048'>      </a>
                <div class='synopsis'>
                  <span class='name'>results</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <p>
                  Get the collection of results as instantiated objects. If WillPaginate is
                  available, the results will be a WillPaginate::Collection instance; if not,
                  it will be a vanilla Array.
                  </p>
                  <h4>Returns</h4>
                  <table>
                  <tr><td valign="top">WillPaginate::Collection or Array:</td><td>Instantiated result objects
                  
                  </td></tr>
                  </table>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000048-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000048-source'><span class="ruby-comment cmt"># File lib/sunspot/search.rb, line 36</span>&#x000A;    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">results</span>&#x000A;      <span class="ruby-ivar">@results</span> <span class="ruby-operator">||=</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@query</span>.<span class="ruby-identifier">page</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-keyword kw">defined?</span>(<span class="ruby-constant">WillPaginate</span><span class="ruby-operator">::</span><span class="ruby-constant">Collection</span>)&#x000A;        <span class="ruby-constant">WillPaginate</span><span class="ruby-operator">::</span><span class="ruby-constant">Collection</span>.<span class="ruby-identifier">create</span>(<span class="ruby-ivar">@query</span>.<span class="ruby-identifier">page</span>, <span class="ruby-ivar">@query</span>.<span class="ruby-identifier">per_page</span>, <span class="ruby-ivar">@solr_result</span>.<span class="ruby-identifier">total_hits</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">pager</span><span class="ruby-operator">|</span>&#x000A;          <span class="ruby-identifier">pager</span>.<span class="ruby-identifier">replace</span>(<span class="ruby-identifier">result_objects</span>)&#x000A;        <span class="ruby-keyword kw">end</span>&#x000A;      <span class="ruby-keyword kw">else</span>&#x000A;        <span class="ruby-identifier">result_objects</span>&#x000A;      <span class="ruby-keyword kw">end</span>&#x000A;    <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000050'>
                <a name='M000050'>      </a>
                <div class='synopsis'>
                  <span class='name'>total</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <p>
                  The total number of documents matching the query parameters
                  </p>
                  <h4>Returns</h4>
                  <table>
                  <tr><td valign="top">Integer:</td><td>Total matching documents
                  
                  </td></tr>
                  </table>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000050-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000050-source'><span class="ruby-comment cmt"># File lib/sunspot/search.rb, line 67</span>&#x000A;    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">total</span>&#x000A;      <span class="ruby-ivar">@total</span> <span class="ruby-operator">||=</span> <span class="ruby-ivar">@solr_result</span>.<span class="ruby-identifier">total_hits</span>&#x000A;    <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id='footer-push'></div>
    </div>
    <div id='footer'>
      <a href="http://github.com/mislav/hanna/tree/master"><strong>Hanna</strong> RDoc template</a>
    </div>
  </body>
</html>

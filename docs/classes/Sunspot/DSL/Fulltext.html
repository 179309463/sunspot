<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
  <head>
    <title>: Sunspot::DSL::Fulltext [Sunspot 0.10.2 - Solr-powered search for Ruby objects - API Documentation]</title>
    <meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
    <link href='../../../rdoc-style.css' media='screen' rel='stylesheet' type='text/css'>
    <script type='text/javascript'>
      //<![CDATA[
        function popupCode(url) {
          window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
        }
        
        function toggleCode(id) {
          var code = document.getElementById(id)
        
          code.style.display = code.style.display != 'block' ? 'block' : 'none'
          return true
        }
        
        // Make codeblocks hidden by default
        document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
      //]]>
    </script>
  </head>
  <body class='page'>
    <div class='class' id='wrapper'>
      <div class='header'>
        <h1 class='name'>
          <span class='type'>Class</span>
          Sunspot::DSL::Fulltext
        </h1>
        <ol class='paths'>
          <li>
            <a href="../../../files/lib/sunspot/dsl/fulltext_rb.html">lib/sunspot/dsl/fulltext.rb</a>
            (<a href="http://github.com/outoftime/sunspot/tree/v0.10.2/lib/sunspot/dsl/fulltext.rb">view online</a>)
          </li>
        </ol>
        <div class='parent'>
          Parent:
          <strong>Object</strong>
        </div>
      </div>
      <div id='content'>
        <div id='text'>
          <div id='description'>
            <p>
            This DSL exposes the functionality provided by Solr&#8217;s fulltext Dismax
            handler.
            </p>
          </div>
          <div id='method-list'>
            <h2>Methods</h2>
            <h3>public instance</h3>
            <ol>
              <li><a href="#M000046">boost</a></li>
              <li><a href="#M000047">boost_fields</a></li>
              <li><a href="#M000043">fields</a></li>
              <li><a href="#M000044">highlight</a></li>
              <li><a href="#M000045">phrase_fields</a></li>
            </ol>
          </div>
          <div id='section'>
            <div id='methods'>
              <h2>Public instance methods</h2>
              <div class='public-instance method' id='method-M000046'>
                <a name='M000046'>      </a>
                <div class='synopsis'>
                  <span class='name'>boost</span>
                  <span class='arguments'>(factor, &amp;block)</span>
                </div>
                <div class='description'>
                  <p>
                  Boost queries allow specification of an arbitrary scope for which matching
                  documents should receive an extra boost. The block is evaluated in the
                  usual scope DSL, and field names are attribute fields, not text fields, as
                  in other scope.
                  </p>
                  <h3>Example</h3>
                  <pre>Sunspot.search(Post) do&#x000A;  keywords 'super fan' do&#x000A;    boost(2.0) do&#x000A;      with(:featured, true)&#x000A;    end&#x000A;  end&#x000A;end</pre>
                  <p>
                  In the above search, featured posts will receive a boost of 2.0.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000046-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000046-source'><span class="ruby-comment cmt"># File lib/sunspot/dsl/fulltext.rb, line 136</span>&#x000A;      <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">boost</span>(<span class="ruby-identifier">factor</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;        <span class="ruby-constant">Sunspot</span><span class="ruby-operator">::</span><span class="ruby-constant">Util</span>.<span class="ruby-identifier">instance_eval_or_call</span>(&#x000A;          <span class="ruby-constant">Scope</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@query</span>.<span class="ruby-identifier">create_boost_query</span>(<span class="ruby-identifier">factor</span>), <span class="ruby-ivar">@setup</span>),&#x000A;          <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>&#x000A;        )&#x000A;      <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000047'>
                <a name='M000047'>      </a>
                <div class='synopsis'>
                  <span class='name'>boost_fields</span>
                  <span class='arguments'>(boosts)</span>
                </div>
                <div class='description'>
                  <p>
                  Add boost to certain fields, without restricting which fields are searched.
                  </p>
                  <h3>Example</h3>
                  <pre>Sunspot.search(Post) do&#x000A;  keywords('pork sandwich') do&#x000A;    boost_fields :title =&gt; 1.5&#x000A;  end&#x000A;end</pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000047-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000047-source'><span class="ruby-comment cmt"># File lib/sunspot/dsl/fulltext.rb, line 155</span>&#x000A;      <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">boost_fields</span>(<span class="ruby-identifier">boosts</span>)&#x000A;        <span class="ruby-identifier">boosts</span>.<span class="ruby-identifier">each_pair</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">field_name</span>, <span class="ruby-identifier">boost</span><span class="ruby-operator">|</span>&#x000A;          <span class="ruby-ivar">@setup</span>.<span class="ruby-identifier">text_fields</span>(<span class="ruby-identifier">field_name</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">field</span><span class="ruby-operator">|</span>&#x000A;            <span class="ruby-ivar">@query</span>.<span class="ruby-identifier">add_fulltext_field</span>(<span class="ruby-identifier">field</span>, <span class="ruby-identifier">boost</span>)&#x000A;          <span class="ruby-keyword kw">end</span>&#x000A;        <span class="ruby-keyword kw">end</span>&#x000A;      <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000043'>
                <a name='M000043'>      </a>
                <div class='synopsis'>
                  <span class='name'>fields</span>
                  <span class='arguments'>(*field_names)</span>
                </div>
                <div class='description'>
                  <p>
                  Specify which fields to search. Field names specified as arguments are
                  given default boost; field boosts can be specified by passing a hash of
                  field names keyed to boost values as the last argument.
                  </p>
                  <p>
                  If you wish to boost certain fields without restricting which fields are
                  searched, use <a href="Fulltext.html#M000047">boost_fields</a>
                  </p>
                  <h3>Example</h3>
                  <pre>Sunspot.search(Post) do&#x000A;  keywords 'search is cool' do&#x000A;    fields(:body, :title =&gt; 2.0)&#x000A;  end&#x000A;end</pre>
                  <p>
                  This would search the :body field with default boost (1.0), and the :title
                  field with a boost of 2.0
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000043-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000043-source'><span class="ruby-comment cmt"># File lib/sunspot/dsl/fulltext.rb, line 32</span>&#x000A;      <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">fields</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">field_names</span>)&#x000A;        <span class="ruby-ivar">@fields_added</span> = <span class="ruby-keyword kw">true</span>&#x000A;        <span class="ruby-identifier">boosted_fields</span> = <span class="ruby-identifier">field_names</span>.<span class="ruby-identifier">pop</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">field_names</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)&#x000A;        <span class="ruby-identifier">field_names</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">field_name</span><span class="ruby-operator">|</span>&#x000A;          <span class="ruby-ivar">@setup</span>.<span class="ruby-identifier">text_fields</span>(<span class="ruby-identifier">field_name</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">field</span><span class="ruby-operator">|</span>&#x000A;            <span class="ruby-ivar">@query</span>.<span class="ruby-identifier">add_fulltext_field</span>(<span class="ruby-identifier">field</span>, <span class="ruby-identifier">field</span>.<span class="ruby-identifier">default_boost</span>)&#x000A;          <span class="ruby-keyword kw">end</span>&#x000A;        <span class="ruby-keyword kw">end</span>&#x000A;        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">boosted_fields</span>&#x000A;          <span class="ruby-identifier">boosted_fields</span>.<span class="ruby-identifier">each_pair</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">field_name</span>, <span class="ruby-identifier">boost</span><span class="ruby-operator">|</span>&#x000A;            <span class="ruby-ivar">@setup</span>.<span class="ruby-identifier">text_fields</span>(<span class="ruby-identifier">field_name</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">field</span><span class="ruby-operator">|</span>&#x000A;              <span class="ruby-ivar">@query</span>.<span class="ruby-identifier">add_fulltext_field</span>(<span class="ruby-identifier">field</span>, <span class="ruby-identifier">boost</span>)&#x000A;            <span class="ruby-keyword kw">end</span>&#x000A;          <span class="ruby-keyword kw">end</span>&#x000A;        <span class="ruby-keyword kw">end</span>&#x000A;      <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000044'>
                <a name='M000044'>      </a>
                <div class='synopsis'>
                  <span class='name'>highlight</span>
                  <span class='arguments'>(*args)</span>
                </div>
                <div class='description'>
                  <p>
                  Enable keyword highlighting for this search. By default, the fields under
                  search will be highlighted; you may also may pass one or more symbol
                  arguments indicating fields to be highlighted (they don&#8217;t even have
                  to be the same fields you&#8217;re searching).
                  </p>
                  <h3>Example</h3>
                  <pre>Sunspot.search(Post) do&#x000A;  keywords 'show me the highlighting' do&#x000A;    highlight :title, :body&#x000A;  end&#x000A;end</pre>
                  <p>
                  You may also pass a hash of options as the last argument. Options are the
                  following:
                  </p>
                  <p>
                  Full disclosure: I barely understand what these options actually do; this
                  documentation is pretty much just copied from the (<a
                  href="http://wiki.apache.org/solr/HighlightingParameters#head-23ecd5061bc2c86a561f85dc1303979fe614b956)[Solr">wiki.apache.org/solr/HighlightingParameters#head-23ecd5061bc2c86a561f85dc1303979fe614b956)[Solr</a>
                  Wiki]
                  </p>
                  <table>
                  <tr><td valign="top">:max_snippets:</td><td>The maximum number of highlighted snippets to generate per field
                  
                  </td></tr>
                  <tr><td valign="top">:fragment_size:</td><td>The number of characters to consider for a highlighted fragment
                  
                  </td></tr>
                  <tr><td valign="top">:merge_continuous_fragments:</td><td>Collapse continuous fragments into a single fragment
                  
                  </td></tr>
                  <tr><td valign="top">:phrase_highlighter:</td><td>Highlight phrase terms only when they appear within the query phrase in the
                  document
                  
                  </td></tr>
                  <tr><td valign="top">:require_field_match:</td><td>If true, a field will only be highlighted if the query matched in this
                  particular field (only has an effect if :phrase_highlighter is true as
                  well)
                  
                  </td></tr>
                  </table>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000044-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000044-source'><span class="ruby-comment cmt"># File lib/sunspot/dsl/fulltext.rb, line 84</span>&#x000A;      <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">highlight</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)&#x000A;        <span class="ruby-identifier">options</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">Hash</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">pop</span> <span class="ruby-operator">:</span> {}&#x000A;        <span class="ruby-identifier">fields</span> = []&#x000A;        <span class="ruby-identifier">args</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">field_name</span><span class="ruby-operator">|</span> <span class="ruby-identifier">fields</span>.<span class="ruby-identifier">concat</span>(<span class="ruby-ivar">@setup</span>.<span class="ruby-identifier">text_fields</span>(<span class="ruby-identifier">field_name</span>)) }&#x000A;&#x000A;        <span class="ruby-ivar">@query</span>.<span class="ruby-identifier">set_highlight</span>(<span class="ruby-identifier">fields</span>, <span class="ruby-identifier">options</span>)&#x000A;      <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000045'>
                <a name='M000045'>      </a>
                <div class='synopsis'>
                  <span class='name'>phrase_fields</span>
                  <span class='arguments'>(boosted_fields)</span>
                </div>
                <div class='description'>
                  <p>
                  Phrase fields are an awesome dismax feature that adds extra boost to
                  documents for which all the fulltext keywords appear in close proximity in
                  one of the given fields. Excellent for titles, headlines, etc.
                  </p>
                  <p>
                  Boosted fields are specified in a hash of field names to a boost, as with
                  the <a href="Fulltext.html#M000043">fields</a> and <a
                  href="Fulltext.html#M000047">boost_fields</a> methods.
                  </p>
                  <h3>Example</h3>
                  <pre>Sunspot.search(Post) do&#x000A;  keywords 'nothing reveals like relevance' do&#x000A;    phrase_fields :title =&gt; 2.0&#x000A;  end&#x000A;end</pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000045-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000045-source'><span class="ruby-comment cmt"># File lib/sunspot/dsl/fulltext.rb, line 108</span>&#x000A;      <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">phrase_fields</span>(<span class="ruby-identifier">boosted_fields</span>)&#x000A;        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">boosted_fields</span>&#x000A;          <span class="ruby-identifier">boosted_fields</span>.<span class="ruby-identifier">each_pair</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">field_name</span>, <span class="ruby-identifier">boost</span><span class="ruby-operator">|</span>&#x000A;            <span class="ruby-ivar">@setup</span>.<span class="ruby-identifier">text_fields</span>(<span class="ruby-identifier">field_name</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">field</span><span class="ruby-operator">|</span>&#x000A;              <span class="ruby-ivar">@query</span>.<span class="ruby-identifier">add_phrase_field</span>(<span class="ruby-identifier">field</span>, <span class="ruby-identifier">boost</span>)&#x000A;            <span class="ruby-keyword kw">end</span>&#x000A;          <span class="ruby-keyword kw">end</span>&#x000A;        <span class="ruby-keyword kw">end</span>&#x000A;      <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id='footer-push'></div>
    </div>
    <div id='footer'>
      <a href="http://github.com/mislav/hanna/tree/master"><strong>Hanna</strong> RDoc template</a>
    </div>
  </body>
</html>
